# Graphing with rrdtool

Generate a fancy graph with rrdtool

## Get ds-names of the rrd file

Take `if_octets.rrd` generated by collectd as an example.

```
$ rrdtool info if_octets.rrd

filename = "if_octets.rrd"                                                  rrd_version = "0003"
step = 10
last_update = 1566689685
header_size = 4928
ds[rx].index = 0
ds[rx].type = "DERIVE"
ds[rx].minimal_heartbeat = 20
ds[rx].min = 0.0000000000e+00
ds[rx].max = NaN
ds[rx].last_ds = "11413522973"
ds[rx].value = 6.7285000000e+03
ds[rx].unknown_sec = 0
ds[tx].index = 1
ds[tx].type = "DERIVE"
ds[tx].minimal_heartbeat = 20
ds[tx].min = 0.0000000000e+00
ds[tx].max = NaN
ds[tx].last_ds = "11528971715"
ds[tx].value = 8.7775000000e+03
ds[tx].unknown_sec = 0
```
The `ds[rx]` represents a data series named `rx`, which tells us there is a ds named `rx` in the database that we can use it for graphing.

## Generate a graph

Knowing there are data series named `rx` and `tx` in the database, we can use `rrdtool graph` to generate the graph.

Reference [rrdgraph](https://oss.oetiker.ch/rrdtool/doc/rrdgraph.en.html) [graphing](https://oss.oetiker.ch/rrdtool/doc/rrdgraph_graph.en.html).

See also [examples](https://oss.oetiker.ch/rrdtool/doc/rrdgraph_examples.en.html)

Use the following argument to generate a fancy graph.

```
Timing
-s --start          Start time
-e --end            End time
-S --step           Steps in second
--start=NOW-100000 --end=now
Lables
-t --title          Set the title of the graph, can use "\n" or "<br/>" to seperate the lines.
-v --vertical-label Lable on the left of the graph.
Size(Applies to graph only, NOT FOR THE WHOLE IMAGE)
-w --width          Width in pixels
-h --height         Height in pixels
Misc
-c --color         Apply color to specific tag, Usage: COLORTAG#rrggbb[aa]
-n --font          Apply font to specific tag, Usage: FONTTAG:size[:font]
Data
DEF:<vname>=<rrdfile>:<ds-name>:<CF>[:step=<step>][:start=<time>][:end=<time>][:reduce=<CF>][:daemon=<address>]
VDEF:vname=RPN expression
CDEF:vname=RPN expression
Graphing
PRINT:vname:format[:strftime|:valstrftime|:valstrfduration]
GPRINT:vname:format
COMMENT:text
VRULE:time#color[:[legend][:dashes[=on_s[,off_s[,on_s,off_s]...]][:dash-offset=offset]]]
HRULE:value#color[:[legend][:dashes[=on_s[,off_s[,on_s,off_s]...]][:dash-offset=offset]]]
LINE[width]:value[#color][:[legend][:STACK][:skipscale][:dashes[=on_s[,off_s[,on_s,off_s]...]][:dash-offset=offset]]]
AREA:value[#color][:[legend][:STACK][:skipscale]]
TICK:vname#rrggbb[aa][:fraction[:legend]]
SHIFT:vname:offset
TEXTALIGN:{left|right|justified|center}
PRINT:vname:CF:format (deprecated)
GPRINT:vname:CF:format (deprecated)
STACK:vname#color[:legend] (deprecated)
```

```
$ rrdtool graph networkio.png -w 600 -h 150 -t "example.com - Network IO"\
    -v "Bit/s" --start=NOW-12800 --end=now \
    DEF:rx=if_octets.rrd:rx:AVERAGE \
    DEF:tx=if_octets.rrd:tx:AVERAGE \
    CDEF:rxbits=rx,8,\* \
    CDEF:txbits=tx,8,\* \
    VDEF:rxsum=rx,TOTAL \
    VDEF:txsum=tx,TOTAL \
    VDEF:rxmax=rxbits,MAXIMUM \
    VDEF:rxavg=rxbits,AVERAGE \
    VDEF:rxmin=rxbits,MINIMUM \
    VDEF:txmax=txbits,MAXIMUM \
    VDEF:txavg=txbits,AVERAGE \
    VDEF:txmin=txbits,MINIMUM \
    LINE1:rxbits#00FF00 \
    LINE1:txbits#0000FF \
    AREA:rxbits#00FF0080:"Inbound " \
    GPRINT:rxmax:"Max.%6.2lf %Sbps" \
    GPRINT:rxmin:"Min.%6.2lf %Sbps" \
    GPRINT:rxavg:"Avg.%6.2lf %Sbps" \
    GPRINT:rxsum:"Total %6.2lf %SB\l" \
    AREA:txbits#0000FF80:"Outbound" \
    GPRINT:txmax:"Max.%6.2lf %Sbps" \
    GPRINT:txmin:"Min.%6.2lf %Sbps" \
    GPRINT:txavg:"Avg.%6.2lf %Sbps" \
    GPRINT:txsum:"Total %6.2lf %SB\l"
```

Then you'll get a fantastic graph.